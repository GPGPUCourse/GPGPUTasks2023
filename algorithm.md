Дан массив a.

На хосте:
1. Разбить массив на воркгруппы;
2. На хосте итерируемся по маске по k бит, начиная с младших;
3. Запускаем кернел calc_counters, получим массив counters;
4. Транспонируем матрицу counters в матрицу counters_t;
5. Сортируем merge сортом массив a до сортированный кусков размера вокргруппы;
5. Запускаем алгоритм префиксных сумм на counters, сохранив ее в массиве sums;
6. Запускаем алгоритм префиксных сумм на counters_t, сохранив ее в массиве sums_t;
7. Запускаем кернел radix_sort;


Кернел calc_sums:
1. В кернеле считаем локальный массив счетчиков каждого числа в маске (local_counters), используя атомарное прибавление;
2. Копируем этот массив в глобальный массив counters с coalesced доступом (этим займутся первые 2^k айтемов из воркгруппы);


Кернел radix_sort:
1. Наше число в массиве a в воркгруппе на позиции i;
2. Получаем отмаскированное значение числа - m;
3. Наша воркгруппа с номером wg;
4. Тогда позиция в res = sums_t[m][wg-1] + i - sums[wg][m-1]
5. Пишем наше число в res по вычисленному индексу